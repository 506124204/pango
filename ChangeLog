2005-09-14  Tor Lillqvist  <tml@novell.com>

	* pango/pangocairo-win32font.c: Use identical glyph extents
	cacheing as in pangocairo-fcfont.c. Huge performance improvement.

2005-09-14  Tor Lillqvist  <tml@novell.com>

	* pango/pangocairo-win32font.c (struct _PangoCairoWin32Font): Have
	a list of metrics by language instead of just one metrics.

	(pango_cairo_win32_font_get_scaled_font): Use the name cwfont
	instead of cffont.

	(free_metrics_info, pango_cairo_win32_font_finalize): Free the
	metrics by language list.

	(create_metrics_for_context): New helper function. Approximate the
	character and digit widths correctly. (#314114)

	(pango_cairo_win32_font_get_metrics): Use the list of metrics by
	language. Call create_metrics_for_context() to measure metrics.
	
	(_pango_cairo_win32_font_new): Keep the PangoWin32Font objects in
	the PangoWin32Face::cached_fonts, like the pangowin32 backend
	does. 

	PangoWin32Face::cached_fonts isn't really a proper cache. It's a
	list with unbound length, one PangoWin32Font per size. Once there
	is cacheing in cairo this can be dropped presumably? What does the
	pangofc backend do? There are too many levels of cacheing going
	on: we have the stuff in pangowin32-fontcache.c (unused now with
	cairo), the PangoWin32FontMap::freed_fonts cache, and the
	PangoWin32::cached_fonts list.

	* pango/pangowin32-fontmap.c (pango_win32_fontmap_cache_remove,
	pango_win32_fontmap_cache_clear): Use GQueue API instead of
	manipulating pointers manually.

	* pango/pangowin32-private.h
	* pango/pangowin32.c: Move PangoWin32MetricsInfo to the private
	header file, as also pangocairo-win32font.c uses it.
	
2005-09-13  Tor Lillqvist  <tml@novell.com>

	* modules/basic/basic-win32.c: Drop unused font_cache variable and
	the call to pango_win32_font_map_for_display() used in its
	initialization, which caused an extra instance of
	PangoWin32FontMap to be created, and fonts enumerated an extra
	time.

2005-09-12  Jean Brefort  <jean.brefort@normalesup.org>

	* pango/pango-attributes.c: (pango_attr_list_splice): Fixed typo
	(#316054).

2005-09-11  Matthias Clasen  <mclasen@redhat.com>

	* pango/pangocairo-fontmap.c (free_context_info): Use g_free()
	to free g_new()-allocated data, otherwise the GLib memory profiler
	becomes very unhappy.

2005-08-26  Behdad Esfahbod  <pango@behdad.org>

	* pango/break.c: Protect against future line-break type additions in
	glib Unicode module.

2005-08-25  Tor Lillqvist  <tml@novell.com>

	* pango/Makefile.am: Use pangocairo.def when linking libpangocairo
	on Windows, instead of relying on GNU ld auto-exporting all public
	symbols.

	* pango/pangocairo.def: Add missing entries. (#314420, Kazuki
	Iwamoto)

2005-08-24  Owen Taylor  <otaylor@redhat.com>

	* pango/pangocairo-render.c (draw_error_underline): convert
	from Pango units to doubles, fix some coordinate space problems
	that had previously been fixed in GTK+. (#313015, Luis Villa)
